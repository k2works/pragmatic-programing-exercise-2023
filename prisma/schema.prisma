// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Account {
  number    String    @id @default(cuid()) @map("口座番号")
  name      String    @map("名義")
  type      String    @map("種別")
  balance   Int       @map("残高")
  updatedAt DateTime? @map("更新日")

  @@map("口座")
}

model RetiredAccount {
  number    String    @id @default(cuid()) @map("口座番号")
  name      String    @map("名義")
  type      String    @map("種別")
  balance   Int       @map("解約時残高")
  retiredAt DateTime? @map("解約日")

  @@map("廃止口座")
}

model Transaction {
  number              Int               @id @default(autoincrement()) @map("取引番号")
  transactionReasonId Int               @map("取引事由ID")
  day                 DateTime          @map("日付")
  accountNumber       String            @map("口座番号")
  income              Int?              @map("入金額")
  outcome             Int?              @map("出金額")
  transactionReason   TransactionReason @relation(fields: [transactionReasonId], references: [id])

  @@map("取引")
}

model TransactionReason {
  id          Int           @id @default(autoincrement()) @map("取引事由ID")
  name        String        @map("取引事由名")
  transaction Transaction[]

  @@map("取引事由")
}

model Product {
  code        String  @id @default(cuid()) @map("商品コード")
  name        String  @map("商品名")
  price       Int     @map("単価")
  type        String  @map("商品区分")
  relatedCode String? @map("関連商品コード")

  product       Product?  @relation(name: "ChildProducts", fields: [relatedCode], references: [code])
  ChildProducts Product[] @relation(name: "ChildProducts")

  @@map("商品")
}

model RetiredProduct {
  code      String    @id @default(cuid()) @map("商品コード")
  name      String    @map("商品名")
  price     Int       @map("単価")
  type      String    @map("商品区分")
  retiredAt DateTime? @map("廃番日")
  quantity  Int       @map("売上個数")

  @@map("廃番商品")
}

model Order {
  day            DateTime @map("日付")
  orderNumber    String   @map("受注番号")
  orderSubNumber Int      @map("受注枝番")
  productCode    String   @map("商品コード")
  quantity       Int      @map("数量")
  couponDiscount Int?     @map("クーポン割引料")

  @@unique([orderNumber, orderSubNumber])
  @@map("注文")
}
